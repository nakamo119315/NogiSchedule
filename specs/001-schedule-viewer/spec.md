# Feature Specification: 乃木坂46スケジュールビューアー

**Feature Branch**: `001-schedule-viewer`
**Created**: 2025-12-21
**Status**: Draft
**Input**: 乃木坂46公式サイトのスケジュールをモダンで見やすく表示するビューアーアプリ

## Clarifications

### Session 2025-12-21

- Q: カレンダー表示形式は？ → A: 月間ビュー（月カレンダー形式で日付ごとにイベント表示）
- Q: 卒業メンバーの表示は？ → A: デフォルト非表示（「卒業メンバーも表示」トグルで切り替え可能）
- Q: 複数メンバーの選択は？ → A: 複数選択可能（選択したメンバーのいずれかが出演するスケジュールを表示）

## User Scenarios & Testing *(mandatory)*

### User Story 1 - スケジュール一覧の閲覧 (Priority: P1)

ファンとして、乃木坂46の今後のスケジュール（TV出演、ラジオ、ライブ等）を一目で確認できる見やすいカレンダー形式の画面を見たい。これにより、公式サイトよりも素早く予定を把握できる。

**Why this priority**: スケジュール確認はアプリの核心機能であり、これなしではアプリの価値がない。最も多くのユーザーが最も頻繁に使用する機能。

**Independent Test**: カレンダー画面を開くだけで、当月のスケジュールがカテゴリ別に色分けされて表示され、各イベントの日時・タイトルが確認できる。

**Acceptance Scenarios**:

1. **Given** ユーザーがアプリを開いた状態で, **When** スケジュール画面を表示する, **Then** 当月のスケジュールがカレンダー形式で表示され、各イベントがカテゴリ別に色分けされている
2. **Given** スケジュール一覧が表示されている状態で, **When** 特定の日付をタップする, **Then** その日のイベント詳細（時間、タイトル、出演メンバー、詳細説明）が表示される
3. **Given** カレンダーが表示されている状態で, **When** 月を切り替える（前月/次月）, **Then** 選択した月のスケジュールが表示される

---

### User Story 2 - メンバーでフィルタリング (Priority: P2)

推しメンバーの活動だけを追いたいファンとして、特定のメンバーでスケジュールをフィルタリングしたい。これにより、自分の推しの出演情報を見逃さない。

**Why this priority**: 98名のメンバーがいる中で、推しメンバーの活動を追跡したいニーズは高い。P1のスケジュール表示があってこそ意味を持つ機能。

**Independent Test**: メンバー選択UIからメンバーを選択すると、そのメンバーが出演するスケジュールのみが表示される。

**Acceptance Scenarios**:

1. **Given** スケジュール一覧が表示されている状態で, **When** メンバーフィルターを開いてメンバーを1名以上選択する, **Then** 選択したメンバーのいずれかが出演するスケジュールのみが表示される
2. **Given** メンバーフィルターが適用されている状態で, **When** フィルターを解除する, **Then** 全メンバーのスケジュールが再度表示される
3. **Given** メンバーフィルターが適用されている状態で, **When** 該当するスケジュールがない月を表示する, **Then** 「該当するスケジュールがありません」とメッセージが表示される

---

### User Story 3 - カテゴリでフィルタリング (Priority: P3)

特定の活動タイプ（TV出演、ライブ、ラジオなど）だけを確認したいファンとして、カテゴリでスケジュールをフィルタリングしたい。

**Why this priority**: カテゴリフィルタはメンバーフィルタと同様に便利だが、より汎用的なニーズ。メンバーフィルタの方が乃木坂ファンには優先度が高い。

**Independent Test**: カテゴリ選択UIからカテゴリを選択すると、そのカテゴリのスケジュールのみが表示される。

**Acceptance Scenarios**:

1. **Given** スケジュール一覧が表示されている状態で, **When** カテゴリフィルターから「TV」を選択する, **Then** TV出演のスケジュールのみが表示される
2. **Given** カテゴリフィルターが適用されている状態で, **When** 別のカテゴリを追加選択する, **Then** 選択した複数カテゴリのスケジュールが表示される
3. **Given** カテゴリとメンバーの両方のフィルターが適用されている状態で, **When** スケジュールを表示する, **Then** 両方の条件を満たすスケジュールのみが表示される

---

### User Story 4 - スケジュール詳細の確認 (Priority: P4)

特定のイベントの詳細情報を知りたいファンとして、スケジュールの詳細画面で全ての情報（放送局、時間、出演メンバー一覧、概要等）を確認したい。

**Why this priority**: 詳細確認は一覧表示の補完機能であり、基本的なスケジュール閲覧ができてから意味を持つ。

**Independent Test**: スケジュール項目をタップすると、詳細情報が表示される。

**Acceptance Scenarios**:

1. **Given** スケジュール一覧が表示されている状態で, **When** 特定のスケジュール項目をタップする, **Then** 詳細画面が表示され、タイトル、日時、カテゴリ、出演メンバー、説明が表示される
2. **Given** 詳細画面が表示されている状態で, **When** 出演メンバーの名前をタップする, **Then** そのメンバーでフィルタリングされたスケジュール一覧に遷移する
3. **Given** 詳細画面が表示されている状態で, **When** 公式サイトへのリンクをタップする, **Then** 公式サイトの該当ページが新しいタブで開く

---

### Edge Cases

- スケジュールデータが取得できない場合（ネットワークエラー）、ユーザーにエラーメッセージを表示し、再試行ボタンを提供する
- 特定の月にスケジュールが存在しない場合、「この月のスケジュールはありません」と表示する
- メンバーコードがスケジュールに含まれているが、メンバー情報が見つからない場合、メンバー名を「不明」と表示する
- 公式APIが一時的に利用不可の場合、キャッシュされたデータがあれば表示し、最終更新日時を明示する

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: システムは乃木坂46公式サイトのスケジュールAPIからデータを取得して表示できること
- **FR-002**: システムは乃木坂46公式サイトのメンバーAPIからメンバー情報を取得し、スケジュールと紐付けできること
- **FR-003**: ユーザーは月間カレンダー形式（月ビュー）でスケジュールを閲覧でき、日付ごとにイベントが表示されること
- **FR-004**: ユーザーは月単位でスケジュールを切り替えられること
- **FR-005**: ユーザーは1人または複数のメンバーを選択してスケジュールをフィルタリングでき、選択したメンバーのいずれかが出演するスケジュールが表示されること
- **FR-006**: ユーザーはカテゴリ（TV、ラジオ、ライブ等）を選択してスケジュールをフィルタリングできること
- **FR-007**: システムはスケジュールをカテゴリ別に色分け表示すること
- **FR-008**: ユーザーはスケジュール項目をタップして詳細情報を確認できること
- **FR-009**: システムはメンバーを世代別（1期生〜6期生）にグループ化して表示すること
- **FR-013**: メンバーフィルター一覧はデフォルトで現役メンバーのみ表示し、「卒業メンバーも表示」トグルで卒業メンバーを含めた表示に切り替えられること
- **FR-010**: システムはオフライン時にキャッシュされたデータを表示できること
- **FR-011**: システムは日本語で表示すること
- **FR-012**: システムはモバイルとデスクトップの両方で使いやすいレスポンシブデザインであること

### Key Entities

- **スケジュール（Schedule）**: イベント情報を表す。属性：識別コード、タイトル、日付、開始時間、終了時間、カテゴリ、説明、出演メンバーコード一覧、公式サイトリンク
- **メンバー（Member）**: 乃木坂46のメンバーを表す。属性：識別コード、名前、英語名、かな、世代（期）、プロフィール画像、卒業フラグ
- **カテゴリ（Category）**: スケジュールの種類を表す。種類：TV、ラジオ、ライブ、CD/音楽、その他

## Assumptions

- 乃木坂46公式サイトのAPI（スケジュール、メンバー）はCORS対応しており、フロントエンドから直接アクセス可能
- APIのレスポンス形式は現在確認したJSONP形式から変更されない
- スケジュールの`arti_code`フィールドはメンバーAPIの`code`フィールドと紐付け可能
- GitHub Pagesでホスティングされ、バックエンドサーバーは使用しない

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: ユーザーはアプリを開いてから3秒以内に当月のスケジュール一覧を確認できる
- **SC-002**: ユーザーはワンタップでメンバーフィルターを適用でき、1秒以内にフィルタリング結果が表示される
- **SC-003**: ユーザーはワンタップでカテゴリフィルターを適用でき、1秒以内にフィルタリング結果が表示される
- **SC-004**: 公式サイトと比較して、同じ情報を確認するのに必要なタップ/クリック数が50%削減される
- **SC-005**: モバイル端末（幅320px以上）でもデスクトップと同等の機能が利用可能
- **SC-006**: オフライン時でも直近に取得したスケジュールデータが閲覧可能
